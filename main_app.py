[the full code content from canvas will be inserted here]